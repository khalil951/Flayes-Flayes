<!DOCTYPE html>
<html>
<head>
    <title>Upload Image</title>
</head>
<body>
    <h1>Upload Image</h1>
    <form id="uploadForm">
        <!-- Hidden input field to store the image URL -->
        <input type="hidden" id="imageUrl" value="{{ vich_uploader_asset(app.user, 'imageFile') }}" required><br><br>

        <label for="type">Type:</label>
        <select id="type" name="type" required>
            <option value="">Select Type</option>
            <option value="pixar">Pixar</option>
            <option value="pixar_plus">Pixar Pro</option>
            <!-- Add other options here -->
        </select><br><br>

        <button type="submit">Submit</button>
    </form>
    
    <!-- Container to display the resulting image -->
    <div id="resultContainer"></div>
    
    <script>
        document.getElementById('uploadForm').addEventListener('submit', async function(event) {
            event.preventDefault();
            
            const formData = new FormData(this);
            
            // Fetch the image URL from the hidden input field
            const imageUrl = document.getElementById('imageUrl').value;
            
            const url = 'https://cartoon-yourself.p.rapidapi.com/facebody/api/portrait-animation/portrait-animation';
            const options = {
                method: 'POST',
                headers: {
                    'X-RapidAPI-Key': '0de95cf9a0mshde653bb78bead1ep13c51cjsn401d254f977e',
                    'X-RapidAPI-Host': 'cartoon-yourself.p.rapidapi.com'
                },
                body: formData
            };
            
            try {
                const response = await fetch(url, options);
                const result = await response.text();
                
                console.log('Image URL:', imageUrl);
                console.log('Resulting Image URL:', result);
                
                // Display the resulting image in the container
                document.getElementById('resultContainer').innerHTML = `<img src="${result}" alt="Resulting Image">`;
            } catch (error) {
                console.error(error);
            }
        });
    </script>
</body>
</html>